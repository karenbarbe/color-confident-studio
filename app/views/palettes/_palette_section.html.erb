<%# locals: (palette:, section:, title:, subtitle:, slots:, max:) %>

<% is_full = palette.slot_full?(section) %>
<% current_count = slots.length %>

<div class="bg-base-100 rounded-xl shadow-sm p-5 space-y-4">
  <%# Section header %>
  <div class="flex justify-between items-start">
    <div>
      <h2 class="font-semibold text-base-content"><%= title %></h2>
      <p class="text-sm text-base-content/50"><%= subtitle %></p>
    </div>
    <span class="text-sm text-base-content/50"><%= current_count %>/<%= max %></span>
  </div>

  <%# Color slots grid %>
  <div class="flex flex-wrap gap-3">
    <%# Existing colors %>
    <% slots.each do |slot| %>
      <%= render "color_slot", slot: slot, palette: palette %>
    <% end %>

    <%# Add button (if not full) %>
    <% unless is_full %>
      <% if policy(palette).pick_color? %>
        <%= link_to pick_color_palette_path(palette, section: section),
          class: "w-16 h-16 sm:w-20 sm:h-20 rounded-lg border-2 border-dashed border-base-content/20 flex items-center justify-center text-base-content/50 hover:border-base-content/40 hover:text-base-content/50 transition-colors" do %>
          <svg xmlns="http://www.w3.org/2000/svg" class="size-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
          </svg>
        <% end %>
      <% end %>
    <% end %>
  </div>

  <%# Empty state hint %>
  <% if current_count == 0 %>
    <p class="text-xs text-amber-600">
      Add at least 1 color to this section
    </p>
  <% end %>
</div>
