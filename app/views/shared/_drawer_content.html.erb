<aside class="bg-base-100 min-h-full w-72 flex flex-col py-2">

  <%# Logo %>
  <div class="h-16 px-3 flex items-center">
    <%= link_to root_path, class: "flex items-center gap-3 h-10 rounded-lg w-full" do %>
      <span class="sidebar-icon sidebar-logo-icon">
        <%= render "shared/logo_isotype" %>
      </span>
      <span class="font-semibold text-lg leading-none truncate">
        Color Confident
      </span>
    <% end %>
  </div>

  <%# Search bar %>
  <div class="px-3 h-16 flex flex-col justify-center">
    <label class="input input-bordered input-sm flex items-center gap-2 w-full">
      <%= icon(:search_outline, css_class: "size-4 opacity-50") %>
      <input type="text" 
             placeholder="Search colors, palettes..." 
             class="grow bg-transparent border-none focus:outline-none text-sm" />
    </label>
  </div>

  <%# Navigation items %>
  <nav class="flex-1 flex flex-col py-2 px-2">
    <ul class="flex flex-col gap-1 flex-1">
      <%# Home %>
      <li>
        <%= link_to dashboard_path, 
            class: sidebar_nav_classes(:home), 
            title: "Home" do %>
          <span class="sidebar-icon">
            <%= icon(:home_outline, css_class: "size-6") %>
          </span>
          <span class="sidebar-label">Home</span>
        <% end %>
      </li>

      <%# Browse %>
      <li>
        <%= link_to color_charts_path, 
            class: sidebar_nav_classes(:browse), 
            title: "Browse" do %>
          <span class="sidebar-icon">
            <%= icon(:swatch_outline, css_class: "size-6") %>
          </span>
          <span class="sidebar-label">Browse</span>
        <% end %>
      </li>

      <%# Create %>
      <li>
        <%= button_to palettes_path, 
            method: :post, 
            class: sidebar_nav_classes(:create), 
            title: "Create", 
            form: { class: "w-full" }, 
            data: { turbo: false } do %>
          <span class="sidebar-icon">
            <%= icon(:create_outline, css_class: "size-6") %>
          </span>
          <span class="sidebar-label">Create</span>
        <% end %>
      </li>

      <%# Stash %>
      <li>
        <%= link_to stash_items_path, 
            class: sidebar_nav_classes(:stash), 
            title: "Stash" do %>
          <span class="sidebar-icon">
            <%= icon(:heart_outline, css_class: "size-6") %>
          </span>
          <span class="sidebar-label">Stash</span>
        <% end %>
      </li>

      <%# Palettes %>
      <li>
        <%= link_to palettes_path, 
            class: sidebar_nav_classes(:palettes), 
            title: "Palettes" do %>
          <span class="sidebar-icon">
            <%= icon(:palette_outline, css_class: "size-6") %>
          </span>
          <span class="sidebar-label">Palettes</span>
        <% end %>
      </li>

      <%# More %>
      <li>
        <details class="group">
          <summary class="flex items-center gap-3 h-10 px-3 rounded-lg cursor-pointer transition-colors text-base-content/70 hover:bg-base-content/5 hover:text-base-content list-none [&::-webkit-details-marker]:hidden">
            <span class="sidebar-icon">
              <%= icon(:ellipsis_horizontal_outline, css_class: "size-6") %>
            </span>
            <span class="sidebar-label">More</span>
            <svg class="size-4 ml-auto transition-transform group-open:rotate-180" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
            </svg>
          </summary>
          <ul class="flex flex-col gap-1 mt-1 ml-9">
            <li>
              <span class="flex items-center gap-3 h-10 px-3 rounded-lg text-sm text-base-content/40 cursor-not-allowed">
                Settings
              </span>
            </li>
            <li>
              <span class="flex items-center gap-3 h-10 px-3 rounded-lg text-sm text-base-content/40 cursor-not-allowed">
                Help
              </span>
            </li>
          </ul>
        </details>
      </li>
    </ul>

    <%# User profile %>
    <div class="mt-auto pt-2 border-t border-base-content/10">
      <details class="group">
        <summary class="flex items-center gap-3 h-10 px-3 rounded-lg cursor-pointer transition-colors hover:bg-base-content/5 list-none [&::-webkit-details-marker]:hidden">
          <%# Avatar %>
          <div class="size-7 rounded-full bg-linear-to-br from-primary to-secondary flex items-center justify-center shrink-0">
            <span class="text-xs font-medium text-primary-content"><%= user_initials(Current.user) %></span>
          </div>
          <%# User info %>
          <div class="flex flex-col min-w-0 flex-1">
            <span class="truncate text-sm font-medium text-base-content"><%= Current.user.first_name %></span>
            <span class="truncate text-xs text-base-content/60"><%= Current.user.email_address %></span>
          </div>
          <%# Chevron %>
          <svg class="size-4 transition-transform group-open:rotate-180 text-base-content/50" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
          </svg>
        </summary>
        <ul class="flex flex-col gap-1 mt-1 ml-2">
          <li>
            <%= link_to user_path(Current.user), 
                class: "flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-base-content/70 hover:bg-base-content/5 hover:text-base-content transition-colors" do %>
              <%= icon(:user_outline, css_class: "size-4") %>
              Profile
            <% end %>
          </li>
          <li>
            <%= button_to session_path, 
                method: :delete, 
                class: "flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-base-content/70 hover:bg-base-content/5 hover:text-base-content transition-colors w-full text-left", 
                form: { class: "w-full" }, 
                data: { turbo: false } do %>
              <%= icon(:sign_out_outline, css_class: "size-4") %>
              Sign out
            <% end %>
          </li>
        </ul>
      </details>
    </div>

  </nav>
</aside>
